{% extends "AppBundle::layout.html.twig" %}

{% block body %}
    {{ parent() }}
    <section class="content">
        <div class="container-fluid">
            <div class="block-header">
                <h2>
                    Projets
                </h2>
            </div>
            <!-- Table des projets -->
            <div id="block-table-projet" class="row clearfix">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="card">
                        <div class="header">
                            <h2 class="col-xs-6">
                                Liste des projets
                            </h2>
                            <div class="col-xs-6 right-side">
                                <button type="button" class="btn btn-primary waves-effect button-new">Nouveau</button>
                            </div>
                        </div>
                        <div class="body">
                            <div class="table-responsive">
                                <table id="table-projet"
                                       class="table table-bordered table-striped table-hover dataTable js-exportable">
                                    <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Nom du projet</th>
                                        <th>Description</th>
                                        <th>Montant</th>
                                        <th>Date de lancement</th>
                                        <th>Date d'attribution</th>
                                        <th>Date de signature</th>
                                        <th>Date de Demarrage</th>
                                        <th>Date de réception</th>
                                        <th>Motif</th>
                                        <th>Observation</th>
                                        <th>Contractant</th>
                                        <th>User</th>
                                        <th>code tp</th>
                                        <th>Type de prestation</th>
                                        <th>Date create</th>
                                        <th>Statut</th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>
                                    <tfoot>
                                    <tr>
                                        <th>Code</th>
                                        <th>Nom du projet</th>
                                        <th>Description</th>
                                        <th>Montant</th>
                                        <th>Date de lancement</th>
                                        <th>Date d'attribution</th>
                                        <th>Date de signature</th>
                                        <th>Date de Demarrage</th>
                                        <th>Date de réception</th>
                                        <th>Motif</th>
                                        <th>Observation</th>
                                        <th>Contractant</th>
                                        <th>User</th>
                                        <th>code tp</th>
                                        <th>Type de prestation</th>
                                        <th>Date create</th>
                                        <th>Statut</th>
                                        <th>Actions</th>
                                    </tr>
                                    </tfoot>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #END# Table projet -->
            <!-- nouveau projet -->
            <div id="block-form-projet" class="row clearfix hidden">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="card">
                        <div class="header">
                            <h2>
                                Nouveau projet
                            </h2>
                        </div>
                        <div class="body">
                            <form id="form-projet" class="form-horizontal">
                                <input type="text" name="id" id="id_projet" class="hidden" >
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="nom">Nom du projet * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="nom" class="form-control nom" placeholder="Veuillez saisir le nom" >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="date_lanc">Date de lancement * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input id="date_lanc" type="text" name="date_lanc" class="datepicker form-control date_lanc" placeholder="Date de lancement ..."  >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="date_attr">Date d'attribution * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="date_attr" class="datepicker form-control date_attr" placeholder="Date d'attribution ..." >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="date_sign">Date de signature * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="date_sign" class="datepicker form-control date_sign" placeholder="Date de signature ..." >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="date_dem">Date de démarrage * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="date_dem" class="datepicker form-control date_dem" placeholder="Date de démarrage ..." >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="date_recep">Date de réception * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="date_recep" class="datepicker form-control date_recep" placeholder="Date de réception ..." >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="date_arret">Date arrêt * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="date_arret" class="datepicker form-control date_recep" placeholder="Date d'arrêt ..." >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="cout">Coût du projet * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="number" name="cout" class="form-control cout" placeholder="Coût ..." >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="tp">Type de prestation * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <select id="list_tp_projet" name="tp" class="form-control show-tick" data-live-search="true">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-lg-offset-2 col-md-offset-2 col-sm-offset-4 col-xs-offset-5">
                                        <button type="button" class="btn btn-primary m-t-15 waves-effect save"><i class="fa fa-spinner fa-spin hidden"></i> Enregistrer</button>
                                        <button type="button" class="btn btn-default m-t-15 waves-effect cancel">Annuler</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #END# nouveau projet -->
            <!-- Ajouter procedure -->
            <div id="block-form-add-proc-projet" class="row clearfix hidden">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="card">
                        <div class="header">
                            <h2>
                                Ajouter une procedure au projet
                            </h2>
                        </div>
                        <div class="body">
                            <form id="form-add-proc-projet" class="form-horizontal">
                                <fieldset>
                                <input type="text" name="id" id="id_projet_form_proc" class="hidden" >
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="nom">Nom du projet </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <input type="text" name="nom" class="form-control nom" readonly >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-sm-4 col-xs-5 form-control-label">
                                        <label for="tp">Choisir une procédure * </label>
                                    </div>
                                    <div class="col-sm-8 col-xs-7">
                                        <div class="form-group">
                                            <div class="form-line">
                                                <select id="list_proc_projet" name="tp" class="form-control show-tick" data-live-search="true">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row clearfix">
                                    <div class="col-lg-offset-2 col-md-offset-2 col-sm-offset-4 col-xs-offset-5">
                                        <button type="button" class="btn btn-primary m-t-15 waves-effect save"><i class="fa fa-spinner fa-spin hidden"></i> Enregistrer</button>
                                        <button type="button" class="btn btn-default m-t-15 waves-effect cancel">Annuler</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #END# ajouter procedure -->
            <!-- Gestion des documents -->
            <div id="block-gestion-docs" class="row clearfix hidden">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="card">
                        <div class="header">
                            <h2>
                                Suivi des documents [<span></span>]
                            </h2>
                        </div>
                        <div class="body">
                            <input type="text" name="id" id="id_projet_pour_doc" class="hidden" >
                            <div class="table-responsive">
                                <table id="table-gestion-docs"
                                       class="table table-bordered table-striped table-hover dataTable js-exportable">
                                    <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Nom du document</th>
                                        <th>Statut de mise à jour</th>
                                        <th>Document modèle</th>
                                        <th>Document mis à jour</th>
                                        <th>Document signé</th>
                                        <th>Date de signature</th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>
                                    <tfoot>
                                    <tr>
                                        <th>Code</th>
                                        <th>Nom du document</th>
                                        <th>Statut de mise à jour</th>
                                        <th>Document modèle</th>
                                        <th>Document mis à jour</th>
                                        <th>Document signé</th>
                                        <th>Date de signature</th>
                                        <th>Actions</th>
                                    </tr>
                                    </tfoot>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                            <div class="row clearfix">
                                <div class="col-lg-offset-2 col-md-offset-2 col-sm-offset-4 col-xs-offset-5">
                                    <button type="button" class="btn btn-primary m-t-15 waves-effect save"><i class="fa fa-spinner fa-spin hidden"></i> Envoyer mail</button>
                                    <button type="button" class="btn btn-default m-t-15 waves-effect cancel">Retour</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #END# Gestion des documents -->
        </div>
    </section>
{% endblock %}

{% block javascript %}
    {{ parent() }}
    <script>
        $(function () {
            //click sur le bouton ajouter cctp
            $('#table-projet').on("click", ".add-cctp", function () {
                var id;
                var row = jQuery(this).closest('tr');

                var i = 0;
                row.find("td").each(function (cellIndex) {
                    if (i === 0) {
                        id = $(this).html();
                    }
                    i++;
                });

                var url = '{{ path("update_projet_add_cctp", {'projet': 'id'}) }}';
                url = url.replace("id", id);
                window.location = url;
            });

            //click sur le bouton ajouter tdr
            $('#table-projet').on("click", ".add-tdr", function () {
                var id;
                var row = jQuery(this).closest('tr');

                var i = 0;
                row.find("td").each(function (cellIndex) {
                    if (i === 0) {
                        id = $(this).html();
                    }
                    i++;
                });

                var url = '{{ path("update_projet_add_tdr", {'projet': 'id'}) }}';
                url = url.replace("id", id);
                window.location = url;
            });
        })
    </script>
{% endblock %}
